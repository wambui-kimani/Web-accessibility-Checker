<template>
    <div class="relative">
        <div class="w-full overflow-x-auto overflow-y-hidden max-sm:py-2 isolate relative max-sm:w-[95vw] m-auto"
            ref="carouselContainer">
            <div
                class="flex items-center w-10/12 justify-around mt-12 h-auto max-sm:mt-2 max-sm:gap-4 m-auto px-4 max-sm:mx-4 carousel -z-10 max-sm:w-fit" id="carousel_items">
                <HighlightCard class="mt-5 h-56">
                    <template #icon>
                        <svg width="150" height="150" viewBox="0 0 150 150" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M17.8499 121.98H63.6893C74.7793 121.98 84.9673 118.075 92.9803 111.574C118.337 94.4357 109.066 61.5847 101.261 47.3013C92.8227 35.9237 79.3343 28.5189 64.135 28.5189C38.5723 28.5189 17.8499 49.2413 17.8499 74.8037V121.98Z"
                                fill="white" />
                            <path
                                d="M94.6207 109.818C85.454 118.984 74.7793 119.633 63.6893 119.633H17.8499V72.4567C17.8499 46.8943 38.5723 26.1719 64.135 26.1719C76.9577 26.1719 86.6 29.6094 95.7667 38.776"
                                stroke="#3D5A80" stroke-width="1.38081" stroke-linecap="round" />
                            <path
                                d="M132.949 74.3593C132.949 60.7443 121.912 49.707 108.297 49.707C94.682 49.707 83.645 60.7443 83.645 74.3593V74.8827C83.645 88.7867 94.9163 100.058 108.82 100.058H132.949V74.3593Z"
                                fill="#3D5A80" fill-opacity="0.8" />
                            <path
                                d="M132.949 74.3593C132.949 60.7443 121.912 49.707 108.297 49.707C94.682 49.707 83.645 60.7443 83.645 74.3593V74.8827C83.645 88.7867 94.9163 100.058 108.82 100.058H132.949V74.3593Z"
                                stroke="#3D5A80" stroke-opacity="0.4" stroke-width="1.38081" />
                            <path
                                d="M67.123 97.2137C67.4907 97.2137 67.8953 97.1037 68.263 96.9203C69.6973 96.2607 70.286 94.648 69.587 93.2187C69.587 93.2187 64.328 81.2337 63.3717 76.8353C63.0037 75.296 62.783 71.2277 62.7097 69.322C62.7097 68.6623 63.0773 68.0757 63.6657 67.8927L75.435 64.374C76.8693 64.0077 77.715 62.3583 77.3473 60.9287C76.9797 59.4993 75.3247 58.6563 73.8903 59.023C73.8903 59.023 63.0037 62.5413 59.0687 62.5413C55.2437 62.5413 44.4307 59.0963 44.4307 59.0963C42.9963 58.7297 41.378 59.3893 40.9 60.819C40.422 62.3583 41.2677 63.971 42.8127 64.3373L54.5817 67.856C55.17 68.039 55.648 68.6257 55.5377 69.2853C55.4273 71.191 55.2437 75.296 54.8757 76.7987C53.9197 81.197 48.6603 93.182 48.6603 93.182C47.9983 94.6113 48.6603 96.224 49.9843 96.8837C50.352 97.067 50.7567 97.177 51.1243 97.177C52.191 97.177 53.2207 96.5903 53.6253 95.5643L59.2523 84.129L64.622 95.6377C65.1003 96.627 66.0563 97.2137 67.123 97.2137Z"
                                fill="#3D5A80" />
                            <path
                                d="M59.2887 59.7907C62.254 59.7907 64.658 57.395 64.658 54.4397C64.658 51.4843 62.254 49.0887 59.2887 49.0887C56.323 49.0887 53.919 51.4843 53.919 54.4397C53.919 57.395 56.323 59.7907 59.2887 59.7907Z"
                                fill="#3D5A80" />
                        </svg>
                    </template>
                    <template #tagline>
                        Inclusivity for everyone
                    </template>
                </HighlightCard>
                <HighlightCard class="-mt-10 h-56 max-sm:mt-5">
                    <template #icon>
                        <svg width="140" height="140" viewBox="0 0 140 140" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M44.121 46.6796C52.7828 46.6796 59.8046 39.6578 59.8046 30.996C59.8046 22.3342 52.7828 15.3124 44.121 15.3124C35.4592 15.3124 28.4374 22.3342 28.4374 30.996C28.4374 39.6578 35.4592 46.6796 44.121 46.6796Z"
                                fill="#E0FBFC" />
                            <path fill-rule="evenodd" clip-rule="evenodd"
                                d="M43.7671 17.5C36.3134 17.5 30.2708 23.5423 30.2708 30.996C30.2708 38.4497 36.3134 44.4922 43.7671 44.4922C51.2207 44.4922 57.2631 38.4497 57.2631 30.996C57.2631 23.5423 51.2207 17.5 43.7671 17.5ZM25.8958 30.996C25.8958 21.1262 33.8971 13.125 43.7671 13.125C53.6368 13.125 61.6381 21.1262 61.6381 30.996C61.6381 40.866 53.6368 48.8672 43.7671 48.8672C33.8971 48.8672 25.8958 40.866 25.8958 30.996Z"
                                fill="#3D5A80" />
                            <path
                                d="M96.2671 46.6796C104.929 46.6796 111.951 39.6578 111.951 30.996C111.951 22.3342 104.929 15.3124 96.2671 15.3124C87.6053 15.3124 80.5835 22.3342 80.5835 30.996C80.5835 39.6578 87.6053 46.6796 96.2671 46.6796Z"
                                fill="white" />
                            <path fill-rule="evenodd" clip-rule="evenodd"
                                d="M96.2671 17.5C88.8134 17.5 82.7708 23.5423 82.7708 30.996C82.7708 38.4497 88.8134 44.4922 96.2671 44.4922C103.721 44.4922 109.763 38.4497 109.763 30.996C109.763 23.5423 103.721 17.5 96.2671 17.5ZM78.3958 30.996C78.3958 21.1262 86.3971 13.125 96.2671 13.125C106.137 13.125 114.138 21.1262 114.138 30.996C114.138 40.866 106.137 48.8672 96.2671 48.8672C86.3971 48.8672 78.3958 40.866 78.3958 30.996Z"
                                fill="#293241" />
                            <path
                                d="M45.2714 49.6565H43.6069C27.9803 49.6565 15.3125 62.3243 15.3125 77.9509H32.8125H43.6069H73.5658C73.5658 62.3243 60.8978 49.6565 45.2714 49.6565Z"
                                fill="#E0FBFC" />
                            <path
                                d="M97.7714 49.6565H96.1069C80.4803 49.6565 67.8125 62.3243 67.8125 77.9509H85.3125H96.1069H126.066C126.066 62.3243 113.398 49.6565 97.7714 49.6565Z"
                                fill="white" />
                            <path
                                d="M71.5214 94.0625H69.8569C54.2303 94.0625 41.5625 106.73 41.5625 122.357H59.0625H69.8569H99.8158C99.8158 106.73 87.1478 94.0625 71.5214 94.0625Z"
                                fill="#98C1D9" fill-opacity="0.93" />
                            <path
                                d="M70.0171 90.4296C78.6789 90.4296 85.7006 83.4078 85.7006 74.746C85.7006 66.0842 78.6789 59.0624 70.0171 59.0624C61.3553 59.0624 54.3335 66.0842 54.3335 74.746C54.3335 83.4078 61.3553 90.4296 70.0171 90.4296Z"
                                fill="#98C1D9" />
                            <path fill-rule="evenodd" clip-rule="evenodd"
                                d="M13.125 77.9509C13.125 61.1161 26.7722 47.469 43.6069 47.469H45.2714C54.2861 47.469 62.389 51.385 67.9665 57.6017C68.7735 58.501 68.6984 59.8839 67.7992 60.6907C66.8999 61.4976 65.5169 61.4226 64.7102 60.5233C59.9272 55.1924 52.9917 51.844 45.2714 51.844H43.6069C29.9252 51.844 18.7015 62.3685 17.5903 75.7634H32.8125C34.0207 75.7634 35 76.7428 35 77.9509C35 79.1591 34.0207 80.1384 32.8125 80.1384H13.125V77.9509ZM41.4194 77.9509C41.4194 76.7428 42.3988 75.7634 43.6069 75.7634H53.5938C54.8019 75.7634 55.7812 76.7428 55.7812 77.9509C55.7812 79.1591 54.8019 80.1384 53.5938 80.1384H43.6069C42.3988 80.1384 41.4194 79.1591 41.4194 77.9509Z"
                                fill="#3D5A80" />
                            <path fill-rule="evenodd" clip-rule="evenodd"
                                d="M39.375 121.701C39.375 104.866 53.0222 91.219 69.8569 91.219H71.5214C88.356 91.219 102.003 104.866 102.003 121.701V123.888H69.8569C68.6488 123.888 67.6694 122.909 67.6694 121.701C67.6694 120.493 68.6488 119.513 69.8569 119.513H97.538C96.4267 106.118 85.2031 95.594 71.5214 95.594H69.8569C56.1752 95.594 44.9516 106.118 43.8403 119.513H59.0625C60.2707 119.513 61.25 120.493 61.25 121.701C61.25 122.909 60.2707 123.888 59.0625 123.888H39.375V121.701Z"
                                fill="#293241" />
                            <path fill-rule="evenodd" clip-rule="evenodd"
                                d="M73.8734 57.0983C79.4316 51.1742 87.3383 47.469 96.1069 47.469H97.7714C114.606 47.469 128.253 61.1161 128.253 77.9509V80.1384H96.1069C94.8988 80.1384 93.9194 79.1591 93.9194 77.9509C93.9194 76.7428 94.8988 75.7634 96.1069 75.7634H123.788C122.677 62.3685 111.453 51.844 97.7714 51.844H96.1069C88.5966 51.844 81.8298 55.0123 77.0641 60.0917C76.2374 60.9728 74.853 61.017 73.9721 60.1904C73.0909 59.3637 73.0467 57.9795 73.8734 57.0983Z"
                                fill="#293241" />
                            <path fill-rule="evenodd" clip-rule="evenodd"
                                d="M70.0171 61.25C62.5634 61.25 56.5208 67.2923 56.5208 74.746C56.5208 82.1997 62.5634 88.2422 70.0171 88.2422C77.4708 88.2422 83.5131 82.1997 83.5131 74.746C83.5131 67.2923 77.4708 61.25 70.0171 61.25ZM52.1458 74.746C52.1458 64.8762 60.1471 56.875 70.0171 56.875C79.8868 56.875 87.8881 64.8762 87.8881 74.746C87.8881 84.616 79.8868 92.6172 70.0171 92.6172C60.1471 92.6172 52.1458 84.616 52.1458 74.746Z"
                                fill="#293241" />
                        </svg>
                    </template>
                    <template #tagline>
                        Attract and retain <br> new customers
                    </template>
                </HighlightCard>
                <HighlightCard class="mt-5 h-56">
                    <template #icon>
                        <svg width="140" height="140" viewBox="0 0 140 140" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M37.1875 15.3125H90.148L123.536 47.0312L124.556 115.808C124.628 120.691 120.69 124.688 115.807 124.688H45.9375C41.1051 124.688 37.1875 120.77 37.1875 115.938V15.3125Z"
                                fill="#E0FBFC" />
                            <path
                                d="M35 21.8368C35 23.0449 35.9793 24.0242 37.1875 24.0242C38.3957 24.0242 39.375 23.0449 39.375 21.8368H35ZM39.375 111.003C39.375 109.795 38.3957 108.815 37.1875 108.815C35.9793 108.815 35 109.795 35 111.003H39.375ZM39.375 21.8368V19.6875H35V21.8368H39.375ZM41.5625 17.5H88.5441V13.125H41.5625V17.5ZM92.7213 19.1578L120.438 45.2692L123.438 42.0847L95.7215 15.9734L92.7213 19.1578ZM122.5 50.0458V120.312H126.875V50.0458H122.5ZM120.312 122.5H45.9375V126.875H120.312V122.5ZM39.375 115.938V111.003H35V115.938H39.375ZM120.438 45.2692C121.754 46.5093 122.5 48.2374 122.5 50.0458H126.875C126.875 47.0319 125.631 44.1514 123.438 42.0847L120.438 45.2692ZM45.9375 122.5C42.313 122.5 39.375 119.562 39.375 115.938H35C35 121.978 39.8969 126.875 45.9375 126.875V122.5ZM88.5441 17.5C90.097 17.5 91.5911 18.093 92.7213 19.1578L95.7215 15.9734C93.7794 14.1439 91.2122 13.125 88.5441 13.125V17.5ZM122.5 120.312C122.5 121.521 121.521 122.5 120.312 122.5V126.875C123.937 126.875 126.875 123.937 126.875 120.312H122.5ZM39.375 19.6875C39.375 18.4794 40.3543 17.5 41.5625 17.5V13.125C37.938 13.125 35 16.0631 35 19.6875H39.375Z"
                                fill="#3D5A80" />
                            <path d="M93 18L123 46H93V18Z" fill="#E0FBFC" stroke="#3D5A80" stroke-width="2" />
                            <path d="M25.3138 62.8191H47.8168V102.825L36.5654 96.157L25.3138 102.825V62.8191Z"
                                fill="#3D5A80" fill-opacity="0.619608" stroke="#3D5A80" stroke-width="2" />
                            <path d="M69.3816 61.5685H96.8853" stroke="#293241" stroke-width="2"
                                stroke-linecap="round" />
                            <path d="M69.3816 77.821H96.8853" stroke="#293241" stroke-width="2"
                                stroke-linecap="round" />
                            <path d="M69.3816 92.8228H96.8853" stroke="#293241" stroke-width="2"
                                stroke-linecap="round" />
                            <path
                                d="M36.5654 77.8212C48.303 77.8212 57.8183 68.306 57.8183 56.5683C57.8183 44.8307 48.303 35.3154 36.5654 35.3154C24.8277 35.3154 15.3125 44.8307 15.3125 56.5683C15.3125 68.306 24.8277 77.8212 36.5654 77.8212Z"
                                fill="white" stroke="#3D5A80" stroke-width="2" />
                        </svg>
                    </template>
                    <template #tagline>
                        Comply with legislation
                    </template>
                </HighlightCard>
            </div>
        </div>
        <div class="flex w-full absolute top-1/2 left-0 justify-between items-center -translate-y-1/2 sm:hidden mt-4">
            <svg width="56" height="56" viewBox="0 0 56 56" fill="none" xmlns="http://www.w3.org/2000/svg"
                class="rotate-180 w-10 h-10 opacity-50 transition-opacity" @click="scrollLeft">
                <path
                    d="M27.9999 55.2C33.3796 55.2 38.6384 53.6047 43.1114 50.616C47.5845 47.6272 51.0708 43.3791 53.1295 38.409C55.1882 33.4388 55.7268 27.9698 54.6773 22.6935C53.6278 17.4173 51.0372 12.5707 47.2332 8.76669C43.4293 4.96271 38.5827 2.37216 33.3064 1.32264C28.0301 0.273125 22.5611 0.811775 17.591 2.87048C12.6208 4.92918 8.37274 8.41547 5.38396 12.8885C2.39519 17.3615 0.799938 22.6203 0.799938 28C0.796993 31.5728 1.49853 35.1111 2.86441 38.4125C4.2303 41.7139 6.23372 44.7135 8.76006 47.2399C11.2864 49.7662 14.2861 51.7696 17.5875 53.1355C20.8889 54.5014 24.4272 55.2029 27.9999 55.2ZM27.9999 7.2C32.1138 7.2 36.1353 8.4199 39.5558 10.7054C42.9763 12.991 45.6423 16.2395 47.2166 20.0402C48.7909 23.8409 49.2028 28.0231 48.4003 32.0579C47.5977 36.0927 45.6167 39.7989 42.7078 42.7078C39.7988 45.6168 36.0926 47.5978 32.0578 48.4003C28.023 49.2029 23.8408 48.791 20.0401 47.2167C16.2394 45.6424 12.9909 42.9764 10.7054 39.5559C8.41983 36.1353 7.19994 32.1138 7.19994 28C7.19445 25.267 7.72872 22.5597 8.77208 20.0337C9.81543 17.5077 11.3473 15.2125 13.2799 13.2799C15.2124 11.3474 17.5076 9.81549 20.0336 8.77214C22.5597 7.72878 25.2669 7.19452 27.9999 7.2ZM22.7199 41.6C23.0089 41.9032 23.3565 42.1446 23.7415 42.3095C24.1265 42.4745 24.5411 42.5595 24.9599 42.5595C25.3788 42.5595 25.7933 42.4745 26.1784 42.3095C26.5634 42.1446 26.9109 41.9032 27.1999 41.6L36.3199 32.48C36.9278 31.8863 37.4108 31.177 37.7406 30.3939C38.0703 29.6108 38.2402 28.7697 38.2402 27.92C38.2402 27.0703 38.0703 26.2292 37.7406 25.4461C37.4108 24.663 36.9278 23.9537 36.3199 23.36L27.1999 14.24C26.6038 13.6558 25.8012 13.3305 24.9666 13.3347C24.1319 13.3389 23.3326 13.6723 22.7425 14.2625C22.1523 14.8527 21.8188 15.652 21.8146 16.4866C21.8104 17.3213 22.1357 18.1239 22.7199 18.72L31.6799 28L22.5599 37.12C21.4399 38.24 21.4399 40.32 22.7199 41.6Z"
                    fill="#3D5A80" />
            </svg>
            <svg width="56" height="56" viewBox="0 0 56 56" fill="none" xmlns="http://www.w3.org/2000/svg"
                class="w-10 h-10 opacity-50 transition-opacity" @click="scrollRight">
                <path
                    d="M27.9999 55.2C33.3796 55.2 38.6384 53.6047 43.1114 50.616C47.5845 47.6272 51.0708 43.3791 53.1295 38.409C55.1882 33.4388 55.7268 27.9698 54.6773 22.6935C53.6278 17.4173 51.0372 12.5707 47.2332 8.76669C43.4293 4.96271 38.5827 2.37216 33.3064 1.32264C28.0301 0.273125 22.5611 0.811775 17.591 2.87048C12.6208 4.92918 8.37274 8.41547 5.38396 12.8885C2.39519 17.3615 0.799938 22.6203 0.799938 28C0.796993 31.5728 1.49853 35.1111 2.86441 38.4125C4.2303 41.7139 6.23372 44.7135 8.76006 47.2399C11.2864 49.7662 14.2861 51.7696 17.5875 53.1355C20.8889 54.5014 24.4272 55.2029 27.9999 55.2ZM27.9999 7.2C32.1138 7.2 36.1353 8.4199 39.5558 10.7054C42.9763 12.991 45.6423 16.2395 47.2166 20.0402C48.7909 23.8409 49.2028 28.0231 48.4003 32.0579C47.5977 36.0927 45.6167 39.7989 42.7078 42.7078C39.7988 45.6168 36.0926 47.5978 32.0578 48.4003C28.023 49.2029 23.8408 48.791 20.0401 47.2167C16.2394 45.6424 12.9909 42.9764 10.7054 39.5559C8.41983 36.1353 7.19994 32.1138 7.19994 28C7.19445 25.267 7.72872 22.5597 8.77208 20.0337C9.81543 17.5077 11.3473 15.2125 13.2799 13.2799C15.2124 11.3474 17.5076 9.81549 20.0336 8.77214C22.5597 7.72878 25.2669 7.19452 27.9999 7.2ZM22.7199 41.6C23.0089 41.9032 23.3565 42.1446 23.7415 42.3095C24.1265 42.4745 24.5411 42.5595 24.9599 42.5595C25.3788 42.5595 25.7933 42.4745 26.1784 42.3095C26.5634 42.1446 26.9109 41.9032 27.1999 41.6L36.3199 32.48C36.9278 31.8863 37.4108 31.177 37.7406 30.3939C38.0703 29.6108 38.2402 28.7697 38.2402 27.92C38.2402 27.0703 38.0703 26.2292 37.7406 25.4461C37.4108 24.663 36.9278 23.9537 36.3199 23.36L27.1999 14.24C26.6038 13.6558 25.8012 13.3305 24.9666 13.3347C24.1319 13.3389 23.3326 13.6723 22.7425 14.2625C22.1523 14.8527 21.8188 15.652 21.8146 16.4866C21.8104 17.3213 22.1357 18.1239 22.7199 18.72L31.6799 28L22.5599 37.12C21.4399 38.24 21.4399 40.32 22.7199 41.6Z"
                    fill="#3D5A80" />
            </svg>
        </div>
    </div>
</template>
<style scoped>
.squish {
    animation: squish 0.5s infinite;
}

@keyframes squish {
    0% {
        scale: 1;
    }

    50% {
        scale: 0.85;
    }

    100% {
        scale: 1;
    }
}
</style>
<script setup lang="ts">
const carouselContainer = ref<HTMLElement | null>(null);
const items = ref<Element[]>([]);
const activeItemIndex = ref(0);

function scrollTo(index: number) {
    if (!items.value.length) return;
    if (index < 0) {
        index = items.value.length - 1 
    }

    if (index >= items.value.length) {
        index = 0
    }

    items.value[index]!.classList.add('active');
    activeItemIndex.value = index;

    const scrollWidth = carouselContainer.value!.scrollWidth;
    carouselContainer.value!.scrollTo({
        left: (scrollWidth / items.value.length) * index - 16,
        behavior: 'smooth'
    });
}

function scrollRight(event: Event) {
    const target = event.target as HTMLElement | null;
    if (!target) return console.warn('No target found', event);

    target.classList.add('squish');
    setTimeout(() => target.classList.remove('squish'), 500);

    items.value[activeItemIndex.value]!.classList.remove('active');
    scrollTo(activeItemIndex.value + 1);
}

function scrollLeft(event: Event) {
    const target = event.target as HTMLElement | null;
    if (!target) return console.warn('No target found', event);

    target.classList.add('squish');
    setTimeout(() => target.classList.remove('squish'), 500);

    items.value[activeItemIndex.value]!.classList.remove('active');
    scrollTo(activeItemIndex.value - 1);
}

onMounted(() => {
    const carousel_items = document.getElementById("carousel_items")
    if (carouselContainer.value && carousel_items) {
        items.value = Array.from(carousel_items.children)
        let activeIndex = items.value.findIndex(item => item.classList.contains('active'));
        if (activeIndex !== -1) items.value[activeIndex]!.classList.remove('active');
        scrollTo(activeItemIndex.value);
    }
})
</script>